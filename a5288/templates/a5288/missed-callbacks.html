{% extends "reports/report_base.html" %}
{% load i18n %}

{% comment %}

    The styles are included in each element rather than in the <style> tag to improve consistency for the emailed HTML report.

{% endcomment %}

{% block reportcontent %}
    <table style="border: 1px solid black; border-spacing: 0;">
        <tr>
            <th style="border: 1px solid black; font-weight: bold; background-color: #CCC; text-align: center; padding: 2px; white-space: nowrap;">Patient ID</th>
            <th style="border: 1px solid black; font-weight: bold; background-color: #CCC; text-align: center; padding: 2px;">Total No Response</th>
            <th style="border: 1px solid black; font-weight: bold; background-color: #CCC; text-align: center; padding: 2px;">Total Indicated</th>
            <th style="border: 1px solid black; font-weight: bold; background-color: #CCC; text-align: center; padding: 2px;">Total Pending</th>
            {% for date in report_data.date_list %}
                <th style="border: 1px solid black; font-weight: bold; background-color: #CCC; text-align: center; padding: 2px;">{{ date }}</th>
            {% endfor %}
        </tr>
        {% for id, info in report_data.data.items %}
        <tr>
            <td style="border: 1px solid black; white-space: nowrap; text-align: center; padding: 2px;">{{ info.recipient.name }}</td>
            <td style="border: 1px solid black; text-align: center; padding: 2px; {% if info.total_no_response > 0 %}background-color: #F33; font-weight: bold;{% endif %}">{{ info.total_no_response }}</td>
            <td style="border: 1px solid black; text-align: center; padding: 2px;">{{ info.total_indicated }}</td>
            <td style="border: 1px solid black; text-align: center; padding: 2px;">{{ info.total_pending }}</td>
            {% for date in info.dates %}
                {% if date.not_sent %}
                    <td style="border: 1px solid black; text-align: center; padding: 2px;">not indicated</td>
                {% else %}
                    {% if date.ok %}
                        <td style="border: 1px solid black; text-align: center; padding: 2px;">OK</td>
                    {% else %}
                        {% if date.no_response %}
                            <td style="border: 1px solid black; text-align: center; background-color: #F33; font-weight: bold; padding: 2px;">No Response</td>
                        {% else %}
                            <td style="border: 1px solid black; text-align: center; padding: 2px;">pending</td>
                        {% endif %}
                    {% endif %}
                {% endif %}
            {% endfor %}
        </tr>
        {% endfor %}
    </table>
{% endblock %}
