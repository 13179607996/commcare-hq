{% extends "domain/admin/domain_admin_base.html" %}
{% block head %}
    {{ block.super }}
    <script>
    $(function() {
        // styling
        $('#notify').addClass("hidden");
        // test url
        $('#test-url').click(function () { 
            var url = $("#id_url").val();
            jQuery.post("{% url test_repeater domain %}", {url: url},
                        function(data){
                            json_res = JSON.parse(data);
                            notice = $('#notify');
                            notice.removeClass("hidden success error");
                            if (json_res.status) {
                                msg = json_res.status + ": " + json_res.response;
                            } else {
                                msg = json_res.response;
                            }
                            if (json_res.success) {
                                notice.addClass("success");
                                notice.text("Success! Response is: " + msg);
                            } else {
                                notice.addClass("error");
                                notice.text("Failed! Response is: " + msg);
                            }
                        });
        });
    });
    </script>
    <style>
        #test-url { padding-left:2em; }
        .error, .success {padding:.8em;margin-top:1em;margin-bottom:1em;border:2px solid #ddd;}
        .success {background:#E6EFC2;color:#264409;border-color:#C6D880;}
        .error {background:#FBE3E4;color:#8a1f11;border-color:#FBC2C4;}
    </style>
{% endblock %}
{% block content %}
<div id="main_container">
    <div id="domain_forwarding">
        <h2 id="header">Forward {% if repeater_type == "FormRepeater"  %}Forms{% else %}Cases{% endif %}</h2>
        <div id="content" >
			<form method="post" action="">
			<table>
			    {{form.as_table}}
			    <tr><td></td><td><input type="submit" value="Start Forwarding" />
			                     <a id="test-url" href="#">Test this link!</a>
			                     <div id="notify"></div></td></tr>
			</table>
        </form>
        </div>
    </div>
</div>
{% endblock %}