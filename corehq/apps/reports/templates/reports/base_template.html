{% extends "reports/standard/base_template.html" %}
{% load compress %}
{% load hq_shared_tags %}
{% load i18n %}
{% block js %}{{ block.super }}
    {% compress js %}
    <script src="{% static 'reports/js/saved_reports.js' %}"></script>
    {% endcompress %}
{% endblock %}

{% block js-inline %}
    <script>
        {% block reports-js-inline %}
        var standardHQReport = hqImport("reports/js/standard_hq_report.js").getStandardHQReport(),
            asyncHQReport = hqImport("reports/js/standard_hq_report.js").getAsyncHQReport();
        {% endblock %}
        $(function() {
            var initial_page_data = hqImport("hqwebapp/js/initial_page_data.js").get;
            var defaultConfig = initial_page_data('default_config') || {};
            if (initial_page_data('has_datespan')) {
                defaultConfig.date_range = 'last7';
            } else {
                defaultConfig.date_range = null;
            }
            defaultConfig.has_ucr_datespan = false;
            defaultConfig.datespan_filters = [];
            defaultConfig.datespan_slug = null;

            var $savedReports = $("#savedReports");
            if ($savedReports.length) {
                $savedReports.reportConfigEditor({
                    filterForm: $("#reportFilters"),
                    items: initial_page_data('report_configs'),
                    defaultItem: defaultConfig,
                    saveUrl: hqImport("hqwebapp/js/urllib.js").reverse("add_report_config"),
                });
            }

            $('#email-enabled').tooltip({
                placement: 'right',
                html: true,
                title: gettext("You can email a saved version<br />of this report."),
            });
        });
    </script>
{% endblock %}

{% block filter_panel %}
    {% include "reports/partials/filter_panel.html" %}
{% endblock %}

{% block additional_initial_page_data %}
    {% initial_page_data 'default_config' default_config %}
    {% initial_page_data 'has_datespan' report.has_datespan %}
    {% initial_page_data 'report_configs' report_configs %}
    {% registerurl 'add_report_config' domain %}
{% endblock %}
