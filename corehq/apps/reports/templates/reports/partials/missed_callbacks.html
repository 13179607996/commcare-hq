<html>
    <head>
        <style type="text/css">
            table, tr, td, th {
                border: 1px solid black;
                border-spacing: 0;
            }
            td, th {
                padding: 5px;
            }
            td.ok {
                color: #0A0;
                font-weight: bold;
            }
            td.no_response {
                background-color: #F11;
                font-weight: bold;
            }
            th {
                font-weight: bold;
                background-color: #CCC;
            }
        </style>
    </head>
    <body>
        <table>
            <tr>
                <th>Patient ID</th>
                {% for date in date_list %}
                    <th>{{ date }}</th>
                {% endfor %}
            </tr>
            {% for id, info in data.items %}
            <tr>
                <td>{{ info.recipient.name }}</td>
                {% for date in info.dates %}
                    {% if date.sms_count == 0 %}
                        <td>(not sent)</td>
                    {% else %}
                        {% if date.call_count > 0 and date.missed_callback_count == 0 %}
                            <td class="ok">OK</td>
                        {% else %}
                            {% if date.missed_callback_count > 0 %}
                                <td class="no_response">No Response</td>
                            {% else %}
                                <td>(pending)</td>
                            {% endif %}
                        {% endif %}
                    {% endif %}
                {% endfor %}
            </tr>
            {% endfor %}
        </table>
    </body>
</html>
