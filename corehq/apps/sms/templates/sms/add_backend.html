{% extends 'hqwebapp/two_column.html' %}
{% load i18n %}
{% load hq_shared_tags %}
{% load timezone_tags %}

{% block title %}
    {% if backend_id %}
        {% trans "Edit SMS Backend" %}
    {% else %}
        {% trans "Add SMS Backend" %}
    {% endif %}
{% endblock %}

{% block head %}
{{ block.super }}
<style>
    .form-block {
        border: 1px solid #EAEAFF;
        background-color: #FAFAFF;
        padding: 20px;
    }
</style>
{% endblock %}

{% block js-inline %}{{ block.super }}
<script>
    function domain_sharing_changed() {
        if($("#id_give_other_domains_access").is(":checked")) {
            $("#id_for_authorized_domains_input").show();
        } else {
            $("#id_for_authorized_domains_input").hide();
        }
    }
    
    $(function(){
        $("#id_give_other_domains_access").click(function() {
            domain_sharing_changed();
        });
        domain_sharing_changed();
    });
</script>
{% endblock %}

{% block page-title %}
    {% if is_global %}
    <ul class="breadcrumb">
        <li>
            <a href="{% url default_sms_admin_interface %}"><strong>SMS Connectivity</strong></a> <span class="divider">&gt;</span>
        </li>
        <li>
            <a href="{% url list_backends %}">SMS Connections</a> <span class="divider">&gt;</span>
        </li>
        <li class="active">
            <div id="report-title">
            {% if backend_id %}
                <a href="{% url edit_backend backend_class_name backend_id %}">Edit SMS Connection</a>
            {% else %}
                <a href="{% url add_backend backend_class_name %}">Add SMS Connection</a>
            {% endif %}
            </div>
        </li>
    </ul>
    {% else %}
    <ul class="breadcrumb">
        <li>
            <a href="{% url messaging domain %}"><strong>Messaging</strong></a> <span class="divider">&gt;</span>
        </li>
        <li>
            <a href="{% url list_domain_backends domain %}">SMS Connectivity</a> <span class="divider">&gt;</span>
        </li>
        <li class="active">
            <div id="report-title">
            {% if backend_id %}
                <a href="{% url edit_domain_backend domain backend_class_name backend_id %}">Edit SMS Connection</a>
            {% else %}
                <a href="{% url add_domain_backend domain backend_class_name %}">Add SMS Connection</a>
            {% endif %}
            </div>
        </li>
    </ul>
    {% endif %}
{% endblock %}

{% block main_column %}
    <div class="page-header"><h3>{{ backend_generic_name }} Connection</h3></div>
    <form action="" method="post">
        <h4>General Settings</h4>
        <div class="form-block">
            <table>
                <tbody>
                    <tr>
                        <td><label for="id_name">Name</label></td>
                        <td><input type="text" name="name" id="id_name" value="{{ form.name.value|default:'' }}" /></td>
                        <td>{{ form.name.errors }}</td>
                    </tr>
                    <tr>
                        <td><label for="id_reply_to_phone_number">Reply To Phone Number</label></td>
                        <td><input type="text" name="reply_to_phone_number" id="id_reply_to_phone_number" value="{{ form.reply_to_phone_number.value|default:'' }}" /></td>
                        <td>{{ form.reply_to_phone_number.errors }}</td>
                    </tr>
                    {% if not is_global %}
                    <tr>
                        <td><label for="id_give_other_domains_access">Give other domains access</label></td>
                        <td><input type="checkbox" name="give_other_domains_access" id="id_give_other_domains_access" {% if form.give_other_domains_access.value %}checked="checked"{% endif %} /></td>
                        <td></td>
                    </tr>
                    <tr id="id_for_authorized_domains_input">
                        <td><label for="id_authorized_domains">List domains here:</label></td>
                        <td><input type="text" name="authorized_domains" id="id_authorized_domains" value="{{ form.authorized_domains.value|default:'' }}" /></td>
                        <td>{{ form.authorized_domains.errors }}</td>
                    </tr>
                    {% endif %}
                </tbody>
            </table>
        </div>
        {% block backend_specific %}{% endblock %}
        <div style="padding-top: 20px;">
            <input type="submit" class="btn btn-primary" value="Save" />
        </div>
    </form>
{% endblock %}
