{% load hq_shared_tags %}
{% load compress %}
{% load statici18n %}
<html lang="{{ LANGUAGE_CODE }}">
    <head>


        {% if less_debug %}
            <link type="text/less"
                  rel="stylesheet"
                  media="all"
                  href="{% static 'style/less/bootstrap.debug.less' %}" />
            <link type="text/less"
                  rel="stylesheet"
                  media="all"
                  href="{% static 'font-awesome/less/font-awesome.less' %}" />
            <link type="text/less"
                  rel="stylesheet"
                  media="all"
                  href="{% static 'style/less/font-commcare.less' %}" />
            <link type="text/less"
                  rel="stylesheet"
                  media="all"
                  href="{% static 'style/less/style.debug.less' %}" />
        {% else %}
        <link type="text/less"
              rel="stylesheet"
              media="all"
              href="{% static 'style/less/bootstrap.less' %}" />
        <link type="text/less"
              rel="stylesheet"
              media="all"
              href="{% static 'font-awesome/less/font-awesome.less' %}" />
        <link type="text/less"
              rel="stylesheet"
              media="all"
              href="{% static 'style/less/font-commcare.less' %}" />
        <link type="text/less"
              rel="stylesheet"
              media="all"
              href="{% static 'style/less/style.less' %}" />
        {% endif %}
        <link type="text/css"
              rel="stylesheet"
              media="screen"
              href="{% static "jquery-ui/themes/redmond/jquery-ui.min.css" %}" />


        <link rel="stylesheet" href="{% static 'nprogress/nprogress.css' %}">
        <link rel="stylesheet" href="{% static 'jquery-ui/themes/base/jquery-ui.min.css' %}">
        <link type="text/css"
              rel="stylesheet"
              media="all"
              href="{% static 'datatables/media/css/jquery.dataTables.min.css' %}"/>
        <link rel="stylesheet" href="{% static 'formplayer/style/webforms.css' %}">
        <link rel="stylesheet" href="{% static 'cloudcare/css/cloudcare.css' %}">
        <link rel="stylesheet" href="{% static 'cloudcare/css/formplayer.css' %}">
        <link rel="stylesheet" href="{% static 'codemirror/lib/codemirror.css' %}"/>



        {% if less_debug %}
        <script>
            less = {
                env: "development",
                useFileCache: true,
                logLevel: 2,
                errorReporting: 'console',
                async: false,
                fileAsync: false,
                poll: 1000,
                functions: {},
                dumpLineNumbers: "comments",
                relativeUrls: false
            };
        </script>
        <script src="{% static 'less/dist/less-1.7.3.min.js' %}"></script>
        {% if less_watch %}<script>less.watch();</script>{% endif %}
        {% endif %}
        <script type="text/javascript" src="{% static 'jquery/dist/jquery.min.js' %}"></script>
        <script src="{% static 'underscore-1.8.3/underscore.js' %}"></script>
        <script type="text/javascript" src="{% static 'bootstrap/dist/js/bootstrap.min.js' %}"></script>
        <script type="text/javascript" src="{% static 'hqwebapp/js/hqModules.js' %}"></script>
        <script type="text/javascript" src="{% static 'style/js/hq.helpers.js' %}"></script>
        {% include "style/includes/ko.html" %}
        <script src="{% statici18n LANGUAGE_CODE %}"></script> {# DO NOT COMPRESS #}

        {% compress js %}
        <!-- UI libraries needed for all other widgets and interactions -->
        <script src="{% static 'jquery-ui/ui/core.js' %}"></script>
        <script src="{% static 'jquery-ui/ui/widget.js' %}"></script>
        <script src="{% static 'jquery-ui/ui/mouse.js' %}"></script>
        <script src="{% static 'jquery-ui/ui/position.js' %}"></script>

        <!-- Individual widgets and interactions -->
        <script src="{% static 'jquery-ui/ui/menu.js' %}"></script>
        <script src="{% static 'jquery-ui/ui/autocomplete.js' %}"></script>
        <script src="{% static 'jquery-ui/ui/button.js' %}"></script>
        <script src="{% static 'jquery-ui/ui/datepicker.js' %}"></script>
        <script src="{% static 'jquery-ui/ui/draggable.js' %}"></script>
        <script src="{% static 'jquery-ui/ui/resizable.js' %}"></script>
        <script src="{% static 'jquery-ui/ui/droppable.js' %}"></script>
        <script src="{% static 'jquery-ui/ui/sortable.js' %}"></script>
        {% endcompress %}

        <!-- For Formplayer's app preview -->
        <script src="{% static 'backbone-1.3.2/backbone.js' %}"></script>
        <script src="{% static 'backbone.marionette/lib/backbone.marionette.js' %}"></script>
        <script src="{% static 'nprogress/nprogress.js' %}"></script>
        <script src="{% static 'moment/min/moment.min.js' %}"></script>
        <script src="{% static 'hqwebapp/js/lib/jquery.textchange.min.js' %}"></script>
        <script src="{% static 'cloudcare/js/util.js' %}"></script>
        <script src="{% static 'cloudcare/js/formplayer/js/apps/util/util.js' %}"></script>
        <script src="{% static 'cloudcare/js/formplayer/app.js' %}"></script>
        <script src="{% static 'cloudcare/js/formplayer/js/entities/cc_app.js' %}"></script>
        <script src="{% static 'cloudcare/js/formplayer/js/entities/menu.js' %}"></script>
        <script src="{% static 'cloudcare/js/formplayer/js/entities/globals.js' %}"></script>
        <script src="{% static 'cloudcare/js/formplayer/js/entities/sessions.js' %}"></script>
        <script src="{% static 'cloudcare/js/formplayer/js/apps/list/list_controller.js' %}"></script>
        <script src="{% static 'cloudcare/js/formplayer/js/apps/list/list_view.js' %}"></script>
        <script src="{% static 'cloudcare/js/formplayer/js/apps/menus/menu_view.js' %}"></script>
        <script src="{% static 'cloudcare/js/formplayer/js/apps/menus/menu_controller.js' %}"></script>
        <script src="{% static 'cloudcare/js/formplayer/js/apps/sessions/session_view.js' %}"></script>
        <script src="{% static 'cloudcare/js/formplayer/js/apps/sessions/session_controller.js' %}"></script>
        <script src="{% static 'cloudcare/js/formplayer/js/apps/session_nav.js' %}"></script>
        <script src="{% static 'style/js/ui-element.js' %}"></script>
        <script src="{% static 'formplayer/script/vendor/markdown-it-4.2.0.min.js' %}"></script>
        <script src="{% static 'formplayer/script/vendor/purify.js' %}"></script>
        <script src="{% static 'formplayer/script/vendor/ba-tiny-pubsub.min.js' %}"></script>
        <script src="{% static 'formplayer/script/vendor/shortcut.js' %}"></script>
        <script src="{% static 'formplayer/script/webformsession.js' %}"></script>
        <script src="{% static 'formplayer/script/formnav-all.js' %}"></script>
        <script src="{% static 'formplayer/script/entrycontrols_full.js' %}"></script>
        <script src="{% static 'formplayer/script/fullform-ui.js' %}"></script>
        <script src="{% static 'preview_app/js/preview_app.js' %}"></script>
    </head>
    <body>
        <div class="container">
            <section id="cloudcare-notifications"></section>
            <section id="case-crumbs" style="width: 800px"></section>
            <section id="cases"></section>
            <section id="webforms" class="webforms" data-bind="template: { name: 'form-fullform-ko-template' }"></section>
            {% if request|toggle_enabled:"INSTANCE_VIEWER" %}
                <section id="cloudcare-debugger" data-bind="
                template: {
                    name: 'instance-viewer-ko-template',
                    afterRender: adjustWidth
                }
            "></section>
            {% endif %}
        </div>

        <div id="menu-container">
            <div id="menu-region" class="container"></div>
        </div>


        <script>
        $(function () {
            hqImport('preview_app/js/preview_app.js').start({
                apps: [{{ app|JSON }}],
                language: "{{ request.user.language|default:'en' }}",
                username: "{{ request.user.username  }}",
                domain: "{{ request.domain }}",
                formplayer_url: "http://localhost:8080",
            })
        })
        </script>
        {% include 'formplayer/fullform-ui/templates.html' %}
        {% include 'formplayer/grid_view.html' %}
        {% include 'formplayer/case_detail.html' %}
        {% include 'formplayer/case_list.html' %}
        {% include 'formplayer/menu_list.html' %}
        {% include 'formplayer/session_list.html' %}
    </body>
</html>
