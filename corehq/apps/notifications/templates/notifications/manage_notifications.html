{% extends 'style/bootstrap3/base_page.html' %}
{% load hq_shared_tags %}
{% block js-inline %}
<script>
$(function () {
    $('#ko-alert-container').koApplyBindings({
        alerts: {{ alerts|JSON }}
    });
});
</script>
{% endblock %}
{% block page_content %}
    <div id="ko-alert-container">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">
                    Create Notification
                </h3>
            </div>
            <div class="panel-body">
                <p>
                    Enter notification text below and preview in the table below.  Notifications will not be public until the
                    "activate notification" button is pressed.
                </p>

                <form method="post" action="{% url 'create_alert' %}" class="form-horizontal" id="alertForm">
                    {% csrf_token %}
                    <div class="form-group">
                        <label for="alert_text" class="control-label col-sm-2">
                            Message
                        </label>
                        <div class="col-sm-8">
                            <textarea name="alert_text" id="alert_text" placeholder="Notification text..." form="alertForm" class="form-control"></textarea>
                        </div>
                    </div>
                    <div class="form-actions">
                        <div class="col-sm-offset-2">
                            <button type="submit" class="btn btn-primary">Preview Notification</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">
                    Current Notifications
                </h3>
            </div>
            <div class="panel-body">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Created</th>
                            <th>Content</th>
                            <th>URL</th>
                            <th>Type</th>
                            <th>Activate Notification</th>
                            <th>Remove Notification</th>
                        </tr>
                    </thead>
                    <tbody data-bind="foreach: alerts">
                        <tr>
                            <td data-bind="text: created"></td>
                            <td data-bind="text: content"></td>
                            <td data-bind="text: url"></td>
                            <td data-bind="text: type"></td>
                            <td>
                                <form method="post" action="">
                                    {% csrf_token %}
                                    <input name="alert_id" type="hidden" data-bind="value: id">
                                    <button type="submit" class="btn btn-success" data-bind="disabled: isActive">Activate</button>
                                </form>
                            </td>
                            <td>
                                <form method="post" action="">
                                    {% csrf_token %}
                                    <input name="alert_id" type="hidden" data-bind="value: id">
                                    <button type="submit" class="btn btn-danger" data-bind="disabled: isActive">Remove</button>
                                </form>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
{% endblock %}
