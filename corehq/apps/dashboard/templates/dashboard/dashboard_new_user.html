{% extends 'dashboard/base.html' %}
{% load i18n %}{% load hq_shared_tags %}

{% block head %}{{ block.super }}
    <script>
        window['_fs_debug'] = false;
        window['_fs_host'] = 'www.fullstory.com';
        window['_fs_org'] = '1APFP';
        (function(m,n,e,t,l,o,g,y){
            g=m[e]=function(a,b){g.q?g.q.push([a,b]):g._api(a,b);};g.q=[];
            o=n.createElement(t);o.async=1;o.src='https://'+_fs_host+'/s/fs.js';
            y=n.getElementsByTagName(t)[0];y.parentNode.insertBefore(o,y);
            g.identify=function(i,v){g(l,{uid:i});if(v)g(l,v)};g.setUserVars=function(v){FS(l,v)};
            g.identifyAccount=function(i,v){o='account';v=v||{};v.acctId=i;FS(o,v)};
            g.clearUserCookie=function(d,i){d=n.domain;while(1){n.cookie='fs_uid=;domain='+d+
                    ';path=/;expires='+new Date(0);i=d.indexOf('.');if(i<0)break;d=d.slice(i+1)}}
        })(window,document,'FS','script','user');
        FS.identify('{{ request.couch_user.username }}',{'displayName': '{{ request.couch_user.username }}'});
    </script>
{% endblock %}

{% block js-inline %}{{ block.super }}
<script>
    $(function() {
        analytics.workflow('Visited new user dashboard');
        var $links = [];
        {% for template in templates %}
            $links.push($('.dashboard-link[data-index="{{ forloop.counter0 }}"]'));
            gaTrackLink($links[{{ forloop.counter0 }}], 'Dashboard', 'Welcome Tile', '{{ template.action }}');
            analytics.trackWorkflowLink($links[{{ forloop.counter0 }}], '{{ template.description }}');
            analytics.trackWorkflowLink($links[{{ forloop.counter0 }}], 'Clicked App Template Tile');
        {% endfor %}
    });
</script>
{% endblock %}

{% block dashboard-content %}
<div class="page-header">
    <h1>{% trans 'What type of app would you like to build?' %}</h1>
</div>
<div class="row">
    {% for template in templates %}
        <div class="col-md-4">
            <div class="panel panel-dashboard">
                <div class="panel-heading">
                    <a class="dashboard-link"
                        data-index="{{ forloop.counter0 }}"
                        href="{{ template.url }}">
                        {{ template.heading }}
                    </a>
                </div>
                <div class="panel-body">
                    <p class="text-center">
                        <a class="dashboard-link"
                            data-index="{{ forloop.counter0 }}"
                            href="{{ template.url }}">
                        <i class="fcc {{ template.icon }} dashboard-icon dashboard-icon-large"></i>
                        <span class="lead">
                            {{ template.lead }}
                        </span>
                    </a></p>
                </div>
            </div>
        </div>
    {% endfor %}
</div>

{% if request|toggle_enabled:'REMOTE_APPS' %}
    <form class="pull-right form" action="{% url "new_app" domain %}" method="post">
        {% csrf_token %}
        <input type="hidden" name="type" value="RemoteApp" />
        <button class="btn btn-default" href="#" type="submit">{% trans "Create a new RemoteApp (Advanced Users Only)" %}</button>
    </form>
{% endif %}

{% endblock dashboard-content %}
