{% extends "adm/forms/admin_adm_item.html" %}
{% block additional-form-content %}
<div id="adm_form_extension">

</div>
<script type="text/javascript">
    $(function() {
        var check_modal_height = function (modal) {
            var win_height = $(window).height();
            modal.css('top', '10px').css('margin-top', '0px');
            modal.find('.modal-body').css('max-height', win_height-180+"px");
        };
        adm_interface.addADMItemModal.on('show', function () {
            check_modal_height($(this));
        });
        adm_interface.updateADMItemModal.on('show', function () {
            check_modal_height($(this));
        });
        var resetSubmitButton = function (item_type) {
            var $submitButton = adm_interface.addADMItemModal.find('button[type="submit"]');
            if (!item_type) {
                $submitButton.addClass('disabled').removeClass('btn-primary');
            } else {
                $submitButton.removeClass('disabled').addClass('btn-primary');
            }
        };
        resetSubmitButton(null);
        adm_interface.addADMItemModal.find('button[type=submit]').button('loading');
        $('#id_column_type').change(function (data) {
            var item_type = $(this).val();
            adm_interface.overrideNewFormType = item_type+"Form";
            adm_interface.overrideNewFormDiv = $("#adm_form_extension");
            resetSubmitButton(item_type);
            if (item_type) {
                $('#adm_form_extension').text("Loading form for "+item_type+"...");
                adm_interface.init_new_form();
            } else {
                $('#adm_form_extension').empty();
            }
        });
    });
</script>
{% endblock %}
