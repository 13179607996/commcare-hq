{% load i18n %}

{% comment %}
TODO:
- Move the fade stuff into an option for the `sortable` binding.
- The span1's don't give the best look...
- Move grip and delete icons into their own widgets/templates
{% endcomment%}


{# Is it bad to inline this style? #}
<table id="properties-table" class="table table-condensed" style="display: inline-block">

    <thead>
        <tr>
            <th></th>
            <th>{% trans "Property" %}</th>
            <th>{% trans "Display Text" %}</th>
            <th>{% trans "Format" %}</th>
            <th></th>
        </tr>
    </thead>

    <tbody data-bind="sortable: {
        data: columns,
        afterAdd: function (elem) { $(elem).hide().fadeIn() },
        beforeRemove: function (elem) { $(elem).fadeOut() }
    }"
    {# there must be no whitespace between <tbody> and <tr> #}
    {# the .hide().fadeIn() will fail badly on FireFox #}
    ><tr data-bind="attr: {'data-order': _sortableOrder}">
        <td class="span1">
            <i class="grip sortable-handle" style="cursor: move;" data-bind="
                css: COMMCAREHQ.icons.GRIP
            "></i>
        </td>

        <td class="control-group">
            <input type="text" data-bind="select2: $parent.propertyOptions, value: property">
        </td>
        <td class="control-group">
            <input type="text" data-bind="value: displayText">
        </td>
        <td>
            <select data-bind="options: $parent.formatOptions, value: format"></select>
        </td>

        <td class="span1">
            <i style="cursor: pointer;"
               title="Delete"
               data-bind="
                click: function(){$parent.columns.remove($data)},
                css: COMMCAREHQ.icons.DELETE
            "></i>
        </td>
    {# there must be no whitespace between <tbody> and <tr> #}
    {# the .hide().fadeIn() will fail badly on FireFox #}
    </tr></tbody>
    <tbody>
        <tr>
            <td></td>
            <td colspan="4">
                <button class="btn" data-bind="
                    click: function(){columns.push(new PropertyListItem());}
                ">
                    Add Property
                </button>
            </td>
        </tr>
    </tbody>
</table>
<input name="sort_properties" type="hidden" data-bind="value: serializedSortProperties">
