{% load i18n %}
{% load hq_shared_tags %}

{% include 'app_manager/v1/partials/case_list_missing_warning.html' %}

<div data-bind="saveButton: longScreen.saveButton"></div>


{% include 'app_manager/v1/partials/custom_detail_variables.html' with screen='longScreen'%}

<legend>
    {% trans "Display Properties" %}
    <span class="hq-help-template"
        data-title="{% trans "Case Detail" %}"
        data-content="{% trans "These properties will be displayed on a confirmation screen after a case has been selected. If no properties are listed here the confirmation screen will not be displayed at all." %}"
    ></span>
</legend>
<div data-bind="with: longScreen">
    {% include 'app_manager/v1/partials/case_list_properties.html' %}
</div>

<div class="btn-group">

    <button class="btn btn-default" data-bind="click: function() { longScreen.addTab(false); }">
        <i class="fa fa-plus"></i>
        {% trans "Add tab" %}
    </button>
 
    {% if request|toggle_enabled:'DETAIL_LIST_TAB_NODESETS' %}
        <button class="btn btn-default dropdown-toggle" data-toggle="dropdown">
            <span class="caret"></span>
        </button>
        <ul class="dropdown-menu">
            <li data-bind="click: function() { longScreen.addTab(false); }"><a>{% trans "Add tab" %}</a></li>
            <li data-bind="click: function() { longScreen.addTab(true); }"><a>{% trans "Add data tab" %}</a></li>
        </ul>
    {% endif %}

</div>

<span class="hq-help-template"
      data-title="{% trans "Case Detail Tabs" %}"
      data-content="{% blocktrans %}Do you have a lot of case properties? Try splitting them into tabs, which will appear as separate screens that mobile users can swipe through. Read more on the <a href='https://help.commcarehq.org/display/commcarepublic/Tabs+on+Case+Detail+Screen' target='_blank'>Help Site</a>.{% endblocktrans %}">
</span>

{% if request|toggle_enabled:"CASE_DETAIL_PRINT" %}
    <br><br>
    <legend>Printing</legend>
    <!-- TODO: if not on 2.35+, show an alert-info instead -->
    <div class="form-group">
        <label class="col-sm-2 control-label">
            {% trans "Document Template" %}
        </label>
        <div class="col-sm-4">
            <a class="btn btn-default existing-media"
               data-bind="visible: print_ref.getUrl(), attr: {href: print_ref.getUrl()}"
               target="_blank"
               data-toggle="tooltip"
               data-title="{% trans "Opens file in new tab." %}">{% trans "View" %}</a>
            <button type="button" class="btn btn-default" data-toggle="modal" data-target="#m1_case_long"
                    data-bind="
                        attr: { 'data-hqmediapath': print_ref.path },
                        event: { mediaUploadComplete: print_ref.uploadComplete },
                    ">
                <i class="fa fa-cloud-upload"></i>
                <span data-bind="{visible: !print_ref.getUrl()}">{% trans "Upload Template" %}</span>
                <span data-bind="{visible: print_ref.getUrl()}">{% trans "Replace Template" %}</span>
            </button>
            <a class="btn btn-danger"
               data-bind="
                    click: removePrintTemplate,
                    visible: print_ref.getUrl(),
            ">
                <i class="fa fa-remove"></i>
            </a>
        </div>
    </div>
{% endif %}
