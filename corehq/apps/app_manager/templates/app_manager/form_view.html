{% extends "app_manager/managed_app.html" %}
{% load xforms_extras %}
{% block form-view %}
    <h3>{{ module.name|trans:langs }} &gt; {{ form.name|trans:langs }}</h3>

    <table class="config">
        {% if edit %}
            <tr class="form editable">
                <th>Form Name</th>
                <td>
                    <input type="text" name="name" />
                    <div class="immutable">{{ form.name|trans:langs }}</div>
                </td>
                <td>
                    <a href="{% url corehq.apps.app_manager.views.edit_form_attr domain app.id module.id form.id  'name' %}" class="submit button">
                        Save
                    </a>
                    <div class="immutable">
                        <a class="edit_link" href="#">edit</a>
                    </div>
                </td>
            </tr>
            <tr class="form editable">
                <th>Requires</th>
                <td>
                    <select class="code" name="requires">
                        <option value="none">none</option>
                        <option value="case">case</option>
                        <option value="referral">referral</option>
                    </select>
                    <div class="immutable"><code>{% firstof form.requires "none" %}</code></div>
                </td>
                <td>
                    <a href="{% url corehq.apps.app_manager.views.edit_form_attr domain app.id module.id form.id  'requires' %}" class="submit button">
                        Save
                    </a>
                    <div class="immutable">
                        <a class="edit_link" href="#">edit</a>
                    </div>
                </td>
            </tr>
            <tr class="form editable">
                <th>Show Count</th>
                <td>
                    <select class="code" name="show_count">
                        <option value="True">True</option>
                        <option value="False">False</option>
                    </select>
                    <div class="immutable"><code>{% if form.show_count %}True{% else %}False{% endif %}</code></div>
                </td>
                <td>
                    <a href="{% url corehq.apps.app_manager.views.edit_form_attr domain app.id module.id form.id  'show_count' %}" class="submit button">
                        Save
                    </a>
                    <div class="immutable">
                        <a class="edit_link" href="#">edit</a>
                    </div>
                </td>
            </tr>
            <tr class="form editable">
                <th>XForm</th>
                <td>
                    <input type="file" name="xform" />
                    <div class="immutable">
                        <code>{{ xform.xmlns }}</code>
                    </div>
                </td>
                <td>
                    <a href="{% url corehq.apps.app_manager.views.edit_form_attr domain app.id module.id form.id  'xform' %}" class="submit button">
                        Upload
                    </a>
                    <div class="immutable">
                        [<a href="#">replace</a>]
                    </div>
                </td>
            </tr>
        {% else %}
            <tr>
                <th>Form Name</th>
                <td>
                    {{ form.name|trans:langs }}
                </td>
            </tr>
            <tr>
                <th>Requires</th>
                <td>
                    <code>{{ form.requires }}</code>
                </td>
            </tr>
            <tr>
                <th>Show Count</th>
                <td>
                    <code>{% if form.show_count %}True{% else %}False{% endif %}</code>
                </td>
            </tr>
            <tr>
                <th>XForm</th>
                <td><code>{{ xform.xmlns }}</code></td>
            </tr>
        {% endif %}
    </table>
    {% if edit and form.unique_id %}
         <form method="POST" action="{{ URL_BASE }}{% url xep_hq_server.views.initiate form.unique_id %}">
            {% csrf_token %}
{#            <input type="hidden" name="callback" value="http://localhost:8010/HQ/?xform_id={{ xform.id }}" />#}
            <input type="hidden" name="callback" value="{{ URL_BASE }}{{ request.get_full_path|safe}}" />
            <input type="hidden" name="editor" value="{{ editor_url }}" />

            <input type="submit" value="Start Editing" />
        </form>
    {% endif %}
    <code>
        {{ form.contents }}
    </code>
{% endblock %}
