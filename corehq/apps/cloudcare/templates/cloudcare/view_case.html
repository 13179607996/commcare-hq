{% extends base_template %}
{% load i18n %}
{% load hq_shared_tags %}

{% block head %}{{ block.super }}
    <style>
        #main_container {
            padding: 10px;
        }
        .key-value-table {
            margin-left: 1em;
        }
        .key-value-table th, .key-value-table td {
            border: 1px solid #ccc;
            vertical-align: middle;
        }
        .key-value-table th {
            color: black;
            text-align: left;
            height: 24px;
            padding-left: 8px;
        }
        .key-value-table td .ui-element-input,
        .key-value-table td .ui-element-select {
            border: 1px solid transparent;
            padding: 2px 1px 2px 3px;
            margin: 1px;
            width: 200px;
            height: 16px;
            display: block;
        }
        .key-value-table td > span {
            display: block;
            width: 100%;
        }
        h1 {
            font-size: 2em;
            text-align: center;
        }
        h2 {
            font-size: 1.2em;
            margin: .5em 0;
        }
        h2, #case-edit-form-edit-link {
            display: inline-block;
            margin-right: 1em;
        }
    </style>
{% endblock %}

{% block js %}{{ block.super }}
    <script src="{% static 'hqwebapp/javascripts/underscore-1.3.1.js' %}"></script>
    <script src="{% static 'hqwebapp/javascripts/jquery.textchange.min.js' %}"></script>
    <script src="{% static 'hqwebapp/js/ui-element.js' %}"></script>
    <script src="{% static 'cloudcare/js/cheapxml.js' %}"></script>
    <script src="{% static 'cloudcare/js/casexml.js' %}"></script>
    <script src="{% static 'cloudcare/js/case-edit-form.js' %}"></script>
{% endblock %}
{% block js-inline %}{{ block.super }}
    <script>
        $(function () {
            var caseEditForm = $('#case-edit-form'),
                user_id = {{ request.couch_user.user_id|JSON }};

            CaseEditForm.init({
                home: caseEditForm,
                commcareCase: {{ case|JSON }},
                user_id: user_id,
                availableProperties: [{
                    key: 'owner_id',
                    label: 'Assigned To',
                    type: 'select',
                    choices: [{
                        label: 'No one',
                        value: '',
                        trueValue: null
                    }, {
                        label: 'Raymond',
                        value: 'XXXRAYMONDXXX'
                    }]
                }, {
                    key: 'edd',
                    label: 'EDD',
                    type: 'date'
                }, {
                    key: 'village',
                    type: 'string',
                    label: 'Village'
                }],
                receiverUrl: "{% url receiver_post domain %}"
            });
//            console.log(casexml.CaseDelta.wrap({{ case|JSON }}).toXML({
//                create: true,
//                user_id: user_id
//            }));
        }());
    </script>
{% endblock %}

{% block content %}
    <div id="main_container">
        <section id="case-edit-form"></section>
    </div>
{% endblock %}