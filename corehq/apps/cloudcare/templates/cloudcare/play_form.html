{% extends base_template %}
{% load hq_shared_tags %}
{% block js %}{{ block.super }}
    <script src="{% static 'cloudcare/js/post.js' %}"></script>
    <script language="javascript" type="text/javascript" src="{{STATIC_URL}}formplayer/script/shortcut.js"></script>
    <script language="javascript" type="text/javascript" src="{{STATIC_URL}}formplayer/script/xforgasm.js?version={{app_version}}"></script>
    <script language="javascript" type="text/javascript" src="{{STATIC_URL}}formplayer/script/formnav-all.js?version={{app_version}}"></script>
    <script language="javascript" type="text/javascript" src="{{STATIC_URL}}formplayer/script/entrycontrols_full.js?version={{app_version}}"></script>
    <script language="javascript" type="text/javascript" src="{{STATIC_URL}}formplayer/script/fullform-ui.js?version={{app_version}}"></script>
    <link rel="stylesheet" href="{{STATIC_URL}}formplayer/style/webforms.css">
{% endblock %}

{% block js-inline %}{{ block.super }}
<script>

        $(function () {
            var formText = "{{ form.render_xform|safe|escapejs}}";
            var formplayerUrl = "{% url xform_play_remote %}";
            var context = "{{ commcare_context|safe|escapejs }}";
            var sess = new WebFormSession({
			    form_content: formText,
			    session_data: context,
			    xform_url: "{% url xform_player_proxy %}"
			    // onpresubmit: onpresubmit,
			    // onsubmit: submit_form_post,
			    // onlanginfo: onlanginfo,
			});
		
		    var init_lang = {% if lang %}'{{ lang|escapejs }}'{% else %}null{% endif %};
		    sess.load($('#webforms'), $('#loading'), init_lang);
		  
            /*
            
            postToUrl(formplayerUrl, {
                xform: formText,
                input_mode: "full",
                next: "{% url cloudcare_form_complete domain app_id module_id form_id %}",
                data: context
            });
            */
        }());
        
</script>
{% endblock %}
{% block content %}
<div id="content" style="min-width: 800px"></div>
{% endblock %}