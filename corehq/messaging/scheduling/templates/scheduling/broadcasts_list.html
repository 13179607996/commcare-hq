{% extends "hqwebapp/base_section.html" %}
{% load hq_shared_tags %}
{% load i18n %}

{% requirejs_main 'scheduling/js/broadcasts_list' %}

{% block stylesheets %}{{ block.super }}
<style>
    .label {
        font-size: 100%;
    }
</style>
{% endblock %}

{% block page_content %}
    {% registerurl 'new_list_broadcasts' domain %}
    {% registerurl 'edit_schedule' domain '---' '---' %}
    <div class="btn-group">
        <a href="{% url 'create_schedule' domain %}" class="btn btn-primary">
            <i class="fa fa-plus"></i>
            {% trans 'Add Broadcast' %}
        </a>
    </div>
    <h4>{% trans 'Scheduled Broadcasts' %}</h4>
    <div>
        <table id="scheduled-table" class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th class="col-md-1">{% trans 'Delete' %}</th>
                    <th class="col-md-4">{% trans 'Name' %}</th>
                    <th class="col-md-3">{% trans 'Last Sent' %}</th>
                    <th class="col-md-2">{% trans 'Status' %}</th>
                    <th class="col-md-2">{% trans 'Action' %}</th>
                </tr>
            </thead>
            <tbody data-bind="foreach: broadcasts">
                <tr>
                    <td class="text-center">
                        <button class="btn btn-danger" data-bind="click: deleteBroadcast">
                            <i class="fa fa-remove"></i>
                        </button>
                    </td>
                    <td>
                        <a data-bind="text: name, attr: {href: editUrl}"></a>
                    </td>
                    <td data-bind="text: last_sent"></td>
                    <td>
                        <span class="label label-success" data-bind="visible: active()">
                            {% trans "Active" %}
                        </span>
                        <span class="label label-danger" data-bind="visible: !active()">
                            {% trans "Inactive" %}
                        </span>
                    </td>
                    <td>
                        <button class="btn btn-default" data-bind="visible: active(), disable: !editable(), click: deactivateBroadcast">
                            {% trans "Deactivate" %}
                        </button>
                        <button class="btn btn-default" data-bind="visible: !active(), disable: !editable(), click: activateBroadcast">
                            {% trans "Activate" %}
                        </button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <h4 style="clear: both">{% trans 'Immediate Broadcasts History' %}</h4>
    <div>
        <table id="immediate-table" class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th class="col-md-8">{% trans 'Name' %}</th>
                    <th class="col-md-4">{% trans 'Sent' %}</th>
                </tr>
            </thead>
            <tbody data-bind="foreach: broadcasts">
                <tr>
                    <td>
                        <a data-bind="text: name, attr: {href: editUrl}"></a>
                    </td>
                    <td data-bind="text: last_sent"></td>
                </tr>
            </tbody>
        </table>
    </div>
{% endblock %}
