{% load hq_shared_tags %}
<script type="text/javascript" src="{{MEDIA_URL}}/receiver/javascripts/annotations.js"></script>
<h1>Health Worker Submission Details</h1>
<h3>Summary view of individual mother data by health workers</h3>
<br>
<table class="sofT">
<thead class="commcare-heading">
{% for col in columns %}
    <th>{{col}}</th>
{% endfor %}
<th>Most Recent Follow-Up</th>
</thead>
<tbody>
<tr>
{% for row in data %}
    {% for col in columns %}
        <td>{{ row|dict_lookup:col }}</td>
    {% endfor %}
    <td style="min-width:200px">{% with row|dict_lookup:"attachment" as attach %}
        {% if attach %}
            {% if attach.most_recent_annotation %}
                {{ attach.most_recent_annotation }}
            {% else %}No follow-ups{% endif %}
            
            <!-- <div class="annotationtrigger js_link" onclick="show_annotations({{attach.id}}, '#dialog');"> -->
            <!-- 
            	The following is a TEMPORARY HACK to demo anticipated sms functionality
            	for Nov 17.
            -->
            <div class="annotationtrigger js_link" onclick="show_annotations('/receiver/annotations/{{attach.id}}?chw_name={{ row|dict_lookup:"Healthcare Worker" }}', '#dialog');">
            
            {% if attach.most_recent_annotation %}view all/add{% else %}add{% endif %} 
            </div>
        {% endif %}
        {% endwith %}
    </td>
</tr>
{% endfor %}
<p><a href="/reports/sql/2/csv">download as csv</a></p>

<div class="message_log" id="dialog">
<a href="#" class="jqmClose">Close</a>
Please wait while that loads... 
</div>
