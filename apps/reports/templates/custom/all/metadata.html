{% load hq_shared_tags %}
<h2>{{ domain }}</h2>
<h2>All Form Submissions</h2>
{% with all_metadata as data %}
{% include "hq/partials/pagination.html" %}
{% endwith %}
<table class="sofT">
    <thead class="commcare-heading">
        {% for column, display in columns %}
          {% ifequal column sort_column %}
             <th class="sorted" id="{% if sort_descending %}descending{% else %}ascending{% endif %}">
               <a href="?sort_column={{column}}&sort_descending={% if sort_descending %}false{% else %}true{% endif %}{% if filters %}&{% dict_as_query_string filters "filter_" %}{% endif %}">
                 {{ display }}
               </a>
             </th>
          {% else %}
             <th><a href="?sort_column={{column}}{% if filters %}&{% dict_as_query_string filters "filter_" %}{% endif %}">{{display}}</a></th>
          {% endifequal %}              
       {% endfor%}        
    </thead>
    <tbody>
        {% for metadata in all_metadata.object_list %}
        <tr>
            {% for column, display in columns %}
                {% ifequal column sort_column %}
                    <td class="sorted">
                {% else %}
                    <td>
                {% endifequal %}
                {% with metadata|attribute_lookup:column as col_value %}
                {% if col_value %}
                    <a href="?filter_{{ column }}={{ col_value }}&{{sort_params}}">{{ col_value }}</a>
                {% else %}
                    {{ col_value }}
                {% endif %}
                </td>
                {% endwith %}
            {% endfor %}
        </tr>
        {% endfor %}
    </tbody>
</table>
