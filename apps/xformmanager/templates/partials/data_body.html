{% load i18n %}

<h2>{% trans "Data for Schema: " %}{{form_name}}</h2>
<a href="{% url xformmanager.views.single_xform xform.id %}">more information about this schema</a>
<br>
<a href="{% url xformmanager.views.export_csv xform.id %}">download csv file</a>
<br>
<a href="{% url xformmanager.views.export_xml xform.id %}">download zip file of xml submissions</a>
<br>
{% if errors %}
    <p class="error">{{ errors }}</p>
{% endif %}
<br>
<div class="pagination">
    <span class="step-links">
        {% if data.has_previous %}
            <a href="?{{param_string_no_page}}&page={{ data.previous_page_number }}"><< Previous</a>
        {% endif %}
        <span class="current">
            Page {{ data.number }} of {{ data.paginator.num_pages }}.
        </span>
        {% if data.has_next %}
            <a href="?{{param_string_no_page}}&page={{ data.next_page_number }}">Next >></a>
        {% endif %}
    </span>
</div>
<form action="{% url xformmanager.views.delete_data xform.id %}" method="POST">
<table class="sofT">
	<thead class="commcare-heading">
	   <tr>
	      <th></th>
	   {% for col in columns %}
	      {% ifequal forloop.counter0 sort_index %}
		     <th class="sorted-{% if sort_descending %}descending{% else %}ascending{% endif %}">
		       <a href="?sort_column={{col}}&sort_descending={% if sort_descending %}false{% else %}true{% endif %}">
		         {{col}}&nbsp&nbsp&nbsp
		         {% comment %}
		          The unfortunate spaces above are because I don't understand 
		          web markup/css enough to make the arrow not go over the text
		          without this hack.  Someone more skilled should fix.
                 {% endcomment %}		           
		     </th>
          {% else %}
		     <th><a href="?sort_column={{col}}">{{col}}</th>
          {% endifequal %}          	
	   {% endfor%}
	   </tr>
	</thead>
    {% for record in data.object_list %}
    <tr class="{% cycle 'odd' 'even' %}">
       <td>
	       <input type="hidden" name="instance" value="{{record|first}}"/>
	       <input type="checkbox" name="checked_{{record|first}}"/>
       </td>
       {% for field in record %}
           {% ifequal forloop.counter0 sort_index %}
                <td class="sorted">
           {% else %}
                <td>
           {% endifequal %}
           {% if forloop.first %}
	   		     <a href = "{%url xformmanager.views.single_instance xform.id field %}">&nbsp;{{ field }}&nbsp;</a>
	   	   {% else %}
	   		     {{field}}
	       {% endif %} 
	   	   </td>
	   {% endfor %}
	</tr>
   {% endfor %}
</table>

{% if data.object_list %}   	
<input type="submit" value="Delete" />
{% endif %}   	

</form>




