{% extends base_template %}
{% load i18n %}
{% load submission_tags %}
{% block title %}{% trans "Submissions Not Matching Any Known Schema" %}{% endblock %}
{% block page_stylesheets %}
    <link type="text/css" rel="stylesheet" href="/static/receiver/stylesheets/receiver.css" />
{% endblock %}
{% block content %}
<h2>{% trans "Submissions Not Matching Any Known Schema" %}</h2>
<p>NOTE: This page currently includes some duplicate submissions, shown in <span class="duplicate">orange</span>.  These will disappear the next time our server migrates.  Please be patient with us.</p>  
{% if errors %}
	<!-- TODO: put this formatting in stylesheets -->
    <label class="error"><strong>{{ errors|escape }}</strong></label>
{% endif %}

<div class="pagination">
 <span class="step-links">
    {% if submissions.has_previous %}
        <a href="?page={{ submissions.previous_page_number }}"><< Previous</a>
    {% endif %}
    <span class="current">
        Page {{ submissions.number }} of {{ submissions.paginator.num_pages }}.
    </span>
    {% if submissions.has_next %}
        <a href="?page={{ submissions.next_page_number }}">Next >></a>
    {% endif %}
</span>
</div>

<form action="" method="POST">
<table class="sofT">
   <thead class="commcare-heading">
    <tr>
        <th></th>
        <th>ID</th><th>Date</th><th>From</th><th>Size (bytes)</th><th>Attachments</th>
    </tr>
   </thead>
   {% for orphan in submissions.object_list %}      
   	<tr class="{% cycle 'odd' 'even' %}">
        <td>
	       <input type="hidden" name="instance" value="{{orphan.id}}"/>
	       <input type="checkbox" name="checked_{{orphan.id}}"/>
        </td>
   		<td><a href="{%url receiver.views.single_submission orphan.id %}">
   		   {% if orphan.is_duplicate %}
                  <span class="duplicate">{{orphan.id}}</span>
           {% else %}
                  {{orphan.id}}
   		   {% endif %}
   		   </a></td>
   		<td>{{orphan.submit_time|date}} - {{orphan.submit_time|time}}</td>
   		<td>{{orphan.submit_ip}}</td>
   		<td>{{orphan.bytes_received}}</td>
   		{% if orphan.xform %}
            <td><a href="{% url receiver.views.single_attachment orphan.xform.id %}">view xml submission</a></td>
        {% else %}
            <td>no xform found</td>
        {% endif %}
   	</tr>	
   {% endfor %}
   </table>

<select name="action">
<option value="resubmit">Resubmit</option>
<option value="delete">Delete</option>
</select>

{% if submissions.object_list %}
    <input type="submit" value="Submit" />
{% endif %}   	

</form>

{% endblock %}
